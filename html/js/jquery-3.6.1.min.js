$(document).ready(function() {
   $(window).resize(function() {
    if ($(window).width() <= 1024) {
        $('#bottomBox').addClass('flex-column');
        $('.box').removeClass('w-25');
        $('.box').addClass('w-75');
    }
    else {
        $("#bottomBox").removeClass('flex-column');
        $('.box').removeClass('w-75');
        $('.box').addClass('w-25');
    }
   });

   $(window).on('load', function () {
    if ($(window).width() <= 1024) {
        $('#bottomBox').addClass('flex-column');
        $('.box').removeClass('w-25');
        $('.box').addClass('w-75');
    }
    else {
        $("#bottomBox").removeClass('flex-column');
        $('.box').removeClass('w-75');
        $('.box').addClass('w-25');
    }
    });

    $(function() {
        $('#partyDate').datepicker({minDate: 0, dateFormat: "yy-mm-dd"});
    });

    function submitActive(value) {
        if (value == true) {
            $('#submit').removeClass('disabled');
            $('#submit').addClass('active');
        }
        else {
            $('#submit').removeClass('active');
            $('#submit').addClass('disabled');
        }
    }

    $('#first').on('blur', function() {
        var valid = /^\D/.test($(this).val());
        if (!valid) {
            $('#firstErr').css("display", "table-row");
            submitActive(false);
        }
        else {
            $('#firstErr').css("display", "none");
            submitActive(true);
        }
    });

    $('#last').on('blur', function() {
        var valid = /^\D/.test($(this).val());
        if (!valid) {
            $('#lastErr').css("display", "table-row");
            submitActive(false);
        }
        else {
            $('#lastErr').css("display", "none");
            submitActive(true);
        }
    });

    $('#partyDate').on('blur', function () {
        var valid = /^\d{4}-\d{2}-\d{2}/.test($(this).val());
        if (!valid) {
            $('#dateErr').css("display", "table-row");
            submitActive(false);
        }
        else {
            $('#dateErr').css("display", "none");
            submitActive(true);
        }
    });

    $('#partyTime').on('blur', function() {
        var dt = new Date();
        var close;
        if (dt.getDay() == 5 || dt.getDay() == 6) {
            close = "21:00:00";
        }
        else {
            close = "20:30:00";
        }

        var checkTime = $('#partyTime').val();
        close = close.split(":");
        checkTime = checkTime.split(":");

        if (checkTime[0] > close[0]) {
            $('#timeErr').css("display", "table-row");
            submitActive(false);
        }
        else if (checkTime[0] == close[0] && checkTime[1] > close[1]) {
            $('#timeErr').css("display", "table-row");
            submitActive(false);
        }
        else {
            $('#timeErr').css("display", "none");
            submitActive(true);
        }
    });

    $('numPeople').on('blur', function () {
        var valid = /^\d/.test($(this).val());
        if (!valid) {
            $('#timeErr').css("display", "table-row");
            submitActive(false);
        }
        else {
            $('#timeErr').css("display", "none");
            submitActive(true);
        }
    });

    $('#bookParty').on('submit', function() {
        var dt = new Date();
        var date = dt.getFullYear() + "-" + (dt.getMonth()+1) + "-" + dt.getDate();

        var minutes;
        var seconds;
        if (dt.getMinutes() <= 9) {
            minutes = "0" + dt.getMinutes();
        }
        else {
            minutes = dt.getMinutes();
        }

        if (dt.getSeconds() <= 9) {
            seconds = "0" + dt.getSeconds();
        }
        else {
            seconds = dt.getSeconds();
        }

        var time = dt.getHours() + ":" + minutes + ":" + seconds;
        $('#bookedDate').val(date);
        $('#bookedTime').val(time);
        console.log(date);
        console.log(dt.toLocaleTimeString());
    });

    function checkComments() {
        if ($("#comments").val().length > 256) {
            $("#commentsErr").css("display", "table-row");
            submitActive(false);
        }
        else {
            $("#commentsErr").css("display", "none");
            submitActive(true);
        }
    }

    $('#comments').on('blur', function() {
        checkComments();
    })

    $('#comments').on('focus', function() {
        checkComments();
    })
});